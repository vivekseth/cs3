04:45:49.765344 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [S], seq 3837929012, win 65535, options [mss 1460,nop,wscale 4,nop,nop,TS val 71620437 ecr 0,sackOK,eol], length 0
E..@..@.@......d.x........&4.........K.............
.D.U........
04:45:50.168960 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [S.], seq 308496191, ack 3837929013, win 5792, options [mss 1448,sackOK,TS val 3100691707 ecr 71620437,nop,wscale 7], length 0
E..<..@....5.x.....d.....cG?..&5.....9.........
.....D.U....
04:45:50.169037 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 1, win 8257, options [nop,nop,TS val 71620840 ecr 3100691707], length 0
E..4..@.@......d.x........&5.cG@.. A.......
.D......
04:45:50.578031 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 1:7, ack 1, win 46, options [nop,nop,TS val 3100692121 ecr 71620840], length 6
E..:..@...Em.x.....d.....cG@..&5...........
.....D..220-

04:45:50.578115 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 7, win 8256, options [nop,nop,TS val 71621249 ecr 3100692121], length 0
E..4..@.@..R...d.x........&5.cGF.. @.......
.D......
04:45:50.987257 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 7:418, ack 1, win 46, options [nop,nop,TS val 3100692516 ecr 71621249], length 411
E.....@...C..x.....d.....cGF..&5...........
...$.D..220-  -- Welcome to Portal of Shanghai Jiao Tong University --
220-  -You are number 22 of 1200 allowed users.
220-  -Local time is Mon Feb 24 16:45:50 2014 now.
220-  -This is a private system - No anonymous login allowed
220-  -You will be disconnected after 15 minutes of inactivity.
220-  ---------------------------------------------------------
220 ProFTPD 1.3.2 Server (public_SJTU) [202.120.2.2]

04:45:50.987330 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 418, win 8230, options [nop,nop,TS val 71621656 ecr 3100692516], length 0
E..4g.@.@.E?...d.x........&5.cH... &.......
.D.....$
04:45:50.987636 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 1:19, ack 418, win 8230, options [nop,nop,TS val 71621656 ecr 3100692516], length 18
E..FD.@.@.hl...d.x........&5.cH... &)......
.D.....$USER shiningmoon

04:45:51.396462 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [.], ack 19, win 46, options [nop,nop,TS val 3100692929 ecr 71621656], length 0
E..4..@...Eq.x.....d.....cH...&G....20.....
.....D..
04:45:51.396526 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 418:457, ack 19, win 46, options [nop,nop,TS val 3100692931 ecr 71621656], length 39
E..[..@...EI.x.....d.....cH...&G.....p.....
.....D..331 Password required for shiningmoon

04:45:51.396594 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 457, win 8228, options [nop,nop,TS val 71622063 ecr 3100692931], length 0
E..4C.@.@.i....d.x........&G.cI... $.z.....
.D......
04:45:51.396838 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 19:32, ack 457, win 8228, options [nop,nop,TS val 71622063 ecr 3100692931], length 13
E..A3.@.@.ym...d.x........&G.cI... $.......
.D......PASS public

04:45:51.805337 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 457:495, ack 32, win 46, options [nop,nop,TS val 3100693374 ecr 71622063], length 38
E..Z..@...EI.x.....d.....cI...&T...........
...~.D..230-  Quotas on: 17.71 MB/500.00 MB 

04:45:51.805405 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 495, win 8226, options [nop,nop,TS val 71622470 ecr 3100693374], length 0
E..4Y.@.@.S....d.x........&T.cI... ".......
.D.F...~
04:45:52.215464 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 495:527, ack 32, win 46, options [nop,nop,TS val 3100693743 ecr 71622470], length 32
E..T..@...EN.x.....d.....cI...&T...........
.....D.F230 User shiningmoon logged in

04:45:52.215539 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 527, win 8224, options [nop,nop,TS val 71622879 ecr 3100693743], length 0
E..4..@.@......d.x........&T.cIN..  	......
.D......
04:45:52.215768 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 32:38, ack 527, win 8224, options [nop,nop,TS val 71622879 ecr 3100693743], length 6
E..:..@.@.+....d.x........&T.cIN..  V	.....
.D......SYST

04:45:52.623349 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 527:546, ack 38, win 46, options [nop,nop,TS val 3100694157 ecr 71622879], length 19
E..G..@...EZ.x.....d.....cIN..&Z...........
.....D..215 UNIX Type: L8

04:45:52.623440 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 546, win 8222, options [nop,nop,TS val 71623285 ecr 3100694157], length 0
E..4..@.@......d.x........&Z.cIa.. ........
.D.u....
04:45:52.623846 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 38:44, ack 546, win 8222, options [nop,nop,TS val 71623285 ecr 3100694157], length 6
E..:[.@.@.R....d.x........&Z.cIa.. .q......
.D.u....FEAT

04:45:53.032891 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 546:581, ack 44, win 46, options [nop,nop,TS val 3100694568 ecr 71623285], length 35
E..W..@...EI.x.....d.....cIa..&`.....g.....
...(.D.u550 FEAT: Operation not permitted

04:45:53.032970 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 581, win 8220, options [nop,nop,TS val 71623693 ecr 3100694568], length 0
E..4.U@.@......d.x........&`.cI... ..*.....
.D.
...(
04:45:53.034375 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 44:49, ack 581, win 8220, options [nop,nop,TS val 71623694 ecr 3100694568], length 5
E..9..@.@."w...d.x........&`.cI... .d......
.D.....(PWD

04:45:53.544362 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 581:615, ack 49, win 46, options [nop,nop,TS val 3100694975 ecr 71623694], length 34
E..V..@...EI.x.....d.....cI...&e....'......
.....D..257 "/" is the current directory

04:45:53.544439 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 615, win 8218, options [nop,nop,TS val 71624202 ecr 3100694975], length 0
E..4g.@.@.EC...d.x........&e.cI... ..p.....
.D.
....
04:45:53.546933 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 49:57, ack 615, win 8218, options [nop,nop,TS val 71624204 ecr 3100694975], length 8
E..<CW@.@.i....d.x........&e.cI... .-m.....
.D......TYPE I

04:45:53.924125 IP 192.168.0.100.58702 > 61.135.185.140.80: Flags [R.], seq 855415382, ack 2782315863, win 16384, length 0
E..(.D@.@..k...d=....N.P2..V...WP.@.....
04:45:53.927674 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 615:634, ack 57, win 46, options [nop,nop,TS val 3100695485 ecr 71624204], length 19
E..G..@...EW.x.....d.....cI...&m...........
.....D..200 Type set to I

04:45:53.927752 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 634, win 8217, options [nop,nop,TS val 71624584 ecr 3100695485], length 0
E..4..@.@......d.x........&m.cI... ........
.D......
04:45:53.928024 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 57:63, ack 634, win 8217, options [nop,nop,TS val 71624584 ecr 3100695485], length 6
E..:..@.@..F...d.x........&m.cI... .K+.....
.D......PASV

----- START passive


04:45:54.260357 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 634:684, ack 63, win 46, options [nop,nop,TS val 3100695871 ecr 71624584], length 50
E..f..@...E7.x.....d.....cI...&s.....t.....
...?.D..227 Entering Passive Mode (202,120,2,2,216,217).

04:45:54.260434 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 684, win 8214, options [nop,nop,TS val 71624916 ecr 3100695871], length 0
E..4..@.@......d.x........&s.cI... ........
.D.....?
04:45:54.261429 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 63:69, ack 684, win 8214, options [nop,nop,TS val 71624916 ecr 3100695871], length 6
E..:..@.@..>...d.x........&s.cI... .L".....
.D.....?LIST

04:45:54.261465 IP 192.168.0.100.58758 > 202.120.2.2.55513: Flags [S], seq 3137237135, win 65535, options [mss 1460,nop,wscale 7,nop,nop,TS val 71624917 ecr 0,sackOK,eol], length 0
E..@.3@.@......d.x........p..........k.............
.D..........
04:45:54.669274 IP 202.120.2.2.55513 > 192.168.0.100.58758: Flags [S.], seq 311559663, ack 3137237136, win 5792, options [mss 1448,sackOK,TS val 3100696204 ecr 71624917,nop,wscale 7], length 0
E..<..@....5.x.....d..........p................
.....D......
04:45:54.669351 IP 192.168.0.100.58758 > 202.120.2.2.55513: Flags [.], ack 1, win 32769, options [nop,nop,TS val 71625323 ecr 3100696204], length 0
E..4".@.@../...d.x........p................
.D.k....
04:45:54.670031 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [.], ack 69, win 46, options [nop,nop,TS val 3100696244 ecr 71624916], length 0
E..4..@...Eh.x.....d.....cI...&y.....E.....
.....D..
04:45:55.077775 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 684:738, ack 69, win 46, options [nop,nop,TS val 3100696608 ecr 71624916], length 54
E..j..@...E1.x.....d.....cI...&y....%......
... .D..150 Opening ASCII mode data connection for file list

04:45:55.077848 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 738, win 8210, options [nop,nop,TS val 71625730 ecr 3100696608], length 0
E..4.L@.@......d.x........&y.cJ!.. ........
.D..... 
04:45:55.080755 IP 202.120.2.2.55513 > 192.168.0.100.58758: Flags [P.], seq 1:929, ack 1, win 46, options [nop,nop,TS val 3100696624 ecr 71625323], length 928
E.....@......x.....d..........p......>.....
...0.D.kdrwxr-xr-x   6 shiningmoon 6000           69 Dec 20  2011 Combinatorics
drwxr-xr-x   7 shiningmoon 6000          405 Nov 30  2011 TeNet
drwxr-xr-x   2 shiningmoon 6000           61 Jul 22  2011 Test3
-rw-r--r--   1 shiningmoon 6000         9914 Jul 13  2011 dragon.zip
-rw-r--r--   1 shiningmoon 6000        20775 Jul 13  2011 jerry5tests.zip
-rw-r--r--   1 shiningmoon 6000      7868350 Jul 13  2011 jerrygen.zip
-rw-r--r--   1 shiningmoon 6000      1946068 May  5  2012 mylog_Sat-May-05-17-27-06-CST-2012.txt
drwxr-xr-x   2 shiningmoon 6000           76 Nov 30  2011 phase1
drwxr-xr-x   2 shiningmoon 6000            6 Nov 10  2009 rename_to_upload
drwxr-xr-x   2 shiningmoon 6000          271 Mar  8  2013 wpl
drwxr-xr-x   2 shiningmoon 6000           94 Mar  8  2013 zy
-rw-r--r--   1 shiningmoon 6000        51712 Mar  7  2013 .......doc
-rw-r--r--   1 shiningmoon 6000       219953 Mar  7  2013 .........docx

04:45:55.080759 IP 202.120.2.2.55513 > 192.168.0.100.58758: Flags [F.], seq 929, ack 1, win 46, options [nop,nop,TS val 3100696624 ecr 71625323], length 0
E..4..@....L.x.....d......	...p.....[D.....
...0.D.k
04:45:55.080849 IP 192.168.0.100.58758 > 202.120.2.2.55513: Flags [.], ack 929, win 32762, options [nop,nop,TS val 71625732 ecr 3100696624], length 0
E..4..@.@.
F...d.x........p...	............
.D.....0
04:45:55.080850 IP 192.168.0.100.58758 > 202.120.2.2.55513: Flags [.], ack 930, win 32762, options [nop,nop,TS val 71625732 ecr 3100696624], length 0
E..4..@.@.~t...d.x........p...	............
.D.....0
04:45:55.096095 IP 192.168.0.100.58758 > 202.120.2.2.55513: Flags [F.], seq 1, ack 930, win 32768, options [nop,nop,TS val 71625746 ecr 3100696624], length 0
E..46.@.@.v....d.x........p...	............
.D.....0
04:45:55.487015 IP 202.120.2.2.55513 > 192.168.0.100.58758: Flags [.], ack 2, win 46, options [nop,nop,TS val 3100697033 ecr 71625746], length 0
E..4..@....K.x.....d......	...p.....X......
.....D..
04:45:55.487094 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 738:761, ack 69, win 46, options [nop,nop,TS val 3100697034 ecr 71625730], length 23
E..K..@...EO.x.....d.....cJ!..&y....D......
.....D..226 Transfer complete


---- VIVEK end passive


04:45:55.487207 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 761, win 8209, options [nop,nop,TS val 71626136 ecr 3100697034], length 0
E..4..@.@......d.x........&y.cJ8.. ..:.....
.D......
04:46:01.268211 IP 192.168.0.100.58705 > 115.239.210.151.80: Flags [F.], seq 1672693161, ack 3983450367, win 16384, length 0
E..(..@.@.:....ds....Q.Pc.E..n..P.@.J...
04:46:11.267752 IP 192.168.0.100.58703 > 61.135.185.140.80: Flags [F.], seq 3289517761, ack 1615966895, win 16384, length 0
E..(.{@.@..4...d=....O.P....`Q..P.@..>..
04:46:13.843817 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [S], seq 679660869, win 65535, options [mss 1460,nop,wscale 4,nop,nop,TS val 71644480 ecr 0,sackOK,eol], length 0
E..@..@.@......d.x......(..E.......................
.E5@........
04:46:14.203272 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [S.], seq 332086014, ack 679660870, win 5792, options [mss 1448,sackOK,TS val 3100715791 ecr 71644480,nop,wscale 7], length 0
E..<..@....5.x.....d......:.(..F....\@.........
..+..E5@....
04:46:14.203344 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 1, win 8257, options [nop,nop,TS val 71644839 ecr 3100715791], length 0
E..4..@.@.."...d.x......(..F..:... A.......
.E6...+.
04:46:14.612298 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 1:7, ack 1, win 46, options [nop,nop,TS val 3100716167 ecr 71644839], length 6
E..:..@......x.....d......:.(..F..../......
..,..E6.220-

04:46:14.612383 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 7, win 8256, options [nop,nop,TS val 71645247 ecr 3100716167], length 0
E..4(.@.@......d.x......(..F..;... @|......
.E8?..,.
04:46:15.021501 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 7:418, ack 1, win 46, options [nop,nop,TS val 3100716566 ecr 71645247], length 411
E.....@......x.....d......;.(..F....#......
.....E8?220-  -- Welcome to Portal of Shanghai Jiao Tong University --
220-  -You are number 24 of 1200 allowed users.
220-  -Local time is Mon Feb 24 16:46:14 2014 now.
220-  -This is a private system - No anonymous login allowed
220-  -You will be disconnected after 15 minutes of inactivity.
220-  ---------------------------------------------------------
220 ProFTPD 1.3.2 Server (public_SJTU) [202.120.2.2]

04:46:15.021571 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 418, win 8230, options [nop,nop,TS val 71645655 ecr 3100716566], length 0
E..4.(@.@.$....d.x......(..F..<... &x;.....
.E9.....
04:46:15.021969 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 1:19, ack 418, win 8230, options [nop,nop,TS val 71645655 ecr 3100716566], length 18
E..F/.@.@.}....d.x......(..F..<... &.......
.E9.....USER shiningmoon

04:46:15.430623 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [.], ack 19, win 46, options [nop,nop,TS val 3100716969 ecr 71645655], length 0
E..4..@......x.....d......<.(..X...........
../..E9.
04:46:15.430739 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 418:457, ack 19, win 46, options [nop,nop,TS val 3100716972 ecr 71645655], length 39
E..[..@......x.....d......<.(..X....D......
../..E9.331 Password required for shiningmoon

04:46:15.430793 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 457, win 8228, options [nop,nop,TS val 71646061 ecr 3100716972], length 0
E..4.D@.@......d.x......(..X..<... $t......
.E;m../.
04:46:15.431055 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 19:32, ack 457, win 8228, options [nop,nop,TS val 71646061 ecr 3100716972], length 13
E..A..@.@......d.x......(..X..<... $a......
.E;m../.PASS public

04:46:15.839536 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 457:495, ack 32, win 46, options [nop,nop,TS val 3100717402 ecr 71646061], length 38
E..Z..@......x.....d......<.(..e....iK.....
..1Z.E;m230-  Quotas on: 17.71 MB/500.00 MB 

04:46:15.839615 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 495, win 8226, options [nop,nop,TS val 71646468 ecr 3100717402], length 0
E..4k.@.@.A....d.x......(..e..<... "qb.....
.E=...1Z
04:46:16.248553 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 495:527, ack 32, win 46, options [nop,nop,TS val 3100717783 ecr 71646468], length 32
E..T..@......x.....d......<.(..e....^......
..2..E=.230 User shiningmoon logged in

04:46:16.248632 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 527, win 8224, options [nop,nop,TS val 71646876 ecr 3100717783], length 0
E..4.X@.@......d.x......(..e..=
..  n/.....
.E>...2.
04:46:16.249838 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 32:39, ack 527, win 8224, options [nop,nop,TS val 71646877 ecr 3100717783], length 7
E..;..@.@..p...d.x......(..e..=
..  .......
.E>...2.CWD /

04:46:16.657879 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 527:555, ack 39, win 46, options [nop,nop,TS val 3100718200 ecr 71646877], length 28
E..P..@......x.....d......=
(..l...........
..4x.E>.250 CWD command successful

04:46:16.657962 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 555, win 8222, options [nop,nop,TS val 71647283 ecr 3100718200], length 0
E..4.&@.@......d.x......(..l..=).. .j......
.E@3..4x
04:46:16.658167 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 39:44, ack 555, win 8222, options [nop,nop,TS val 71647283 ecr 3100718200], length 5
E..9..@.@..=...d.x......(..l..=).. ..d.....
.E@3..4xPWD

04:46:17.066988 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 555:589, ack 44, win 46, options [nop,nop,TS val 3100718608 ecr 71647283], length 34
E..V..@......x.....d......=)(..q.....1.....
..6..E@3257 "/" is the current directory

04:46:17.067067 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 589, win 8220, options [nop,nop,TS val 71647691 ecr 3100718608], length 0
E..4-Q@.@......d.x......(..q..=K.. .g......
.EA...6.
04:46:17.067954 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 44:52, ack 589, win 8220, options [nop,nop,TS val 71647691 ecr 3100718608], length 8
E..<.l@.@......d.x......(..q..=K.. ........
.EA...6.TYPE I

04:46:17.476357 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 589:608, ack 52, win 46, options [nop,nop,TS val 3100719017 ecr 71647691], length 19
E..G..@......x.....d......=K(..y...........
..7..EA.200 Type set to I

04:46:17.476451 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 608, win 8219, options [nop,nop,TS val 71648098 ecr 3100719017], length 0
E..4fC@.@.F....d.x......(..y..=^.. .d7.....
.ECb..7.
04:46:17.477892 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 52:58, ack 608, win 8219, options [nop,nop,TS val 71648099 ecr 3100719017], length 6
E..:..@.@......d.x......(..y..=^.. ........
.ECc..7.PASV


---- START passive
passive port is 50800

04:46:17.885229 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 608:658, ack 58, win 46, options [nop,nop,TS val 3100719425 ecr 71648099], length 50
E..f..@....}.x.....d......=^(..............
..9A.ECc227 Entering Passive Mode (202,120,2,2,198,112).

04:46:17.885304 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 658, win 8215, options [nop,nop,TS val 71648505 ecr 3100719425], length 0
E..4..@.@..W...d.x......(.....=... .`......
.ED...9A

04:46:17.886087 IP 192.168.0.100.58760 > 202.120.2.2.50800: Flags [S], seq 3098277480, win 65535, options [mss 1460,nop,wscale 7,nop,nop,TS val 71648505 ecr 0,sackOK,eol], length 0
E..@..@.@..R...d.x.....p...h.........(.............
.ED.........
04:46:17.886113 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 58:75, ack 658, win 8215, options [nop,nop,TS val 71648505 ecr 3100719425], length 17
E..E	.@.@..v...d.x......(.....=... .]I.....
.ED...9ARETR dragon.zip

04:46:18.294082 IP 202.120.2.2.50800 > 192.168.0.100.58760: Flags [S.], seq 327552066, ack 3098277481, win 5792, options [mss 1448,sackOK,TS val 3100719830 ecr 71648505,nop,wscale 7], length 0
E..<..@....5.x.....d.p.....B...i...............
..:..ED.....
04:46:18.294178 IP 192.168.0.100.58760 > 202.120.2.2.50800: Flags [.], ack 1, win 32769, options [nop,nop,TS val 71648912 ecr 3100719830], length 0
E..4.y@.@.)....d.x.....p...i...C...........
.EF...:.
04:46:18.294605 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [.], ack 75, win 46, options [nop,nop,TS val 3100719871 ecr 71648505], length 0
E..4..@......x.....d......=.(.......~......
..:..ED.
04:46:18.703170 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 658:727, ack 75, win 46, options [nop,nop,TS val 3100720233 ecr 71648505], length 69
E..y..@....h.x.....d......=.(.......I......
..<i.ED.150 Opening BINARY mode data connection for dragon.zip (9914 bytes)

04:46:18.703244 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 727, win 8211, options [nop,nop,TS val 71649320 ecr 3100720233], length 0
E..4?.@.@.md...d.x......(.....=... .Z+.....
.EH(..<i
04:46:18.704512 IP 202.120.2.2.50800 > 192.168.0.100.58760: Flags [.], seq 1:1437, ack 1, win 46, options [nop,nop,TS val 3100720249 ecr 71648912], length 1436
E...0*@....w.x.....d.p.....C...i....M......
..<y.EF.PK..
......n
-................dragon4.out22196
PK.........o
-4i.m........
...dragon5.in5T..$1............J..j..7.$.4.(~..?.+.}..WL.UyrI..)$O.....W..n.[...{~.!#....f.0....J.}.W....Wc.....464...<x8(T.%....-6... ..F..?z....=.d..n...S.....o7..!.:{L.[...e.,|[..,=..w..#Y....-..`.VuX.L|.X.....b!.aDa)..W.X%c.YK..d.........	.-.......W.L...h ...<.....9{..{KG/..dj.f .9..P6.L............GM3C..5......-...J.<......]fH..'X".-..!......Q#l..RX.....6.....2I.....^,..qV.2....j1.........l..5BA#.d....U.5Y......9.$.....&.....>....@b...[.?.....<4.....]2..oc.:v....^i
v.sWv.d..d./|6.Lb..9x..........]1.)..[..@..s.`......3...h,.-<vgv..p.......p^.....+\=..*.......>._..D...m.C......S<..t......./.H.T0)..u
....... ...(.e..y..yF.w...s./..-....gl\..}....^?......c....l.7.wp....=
.'.FSj..(.b....J.A.....#..R....K...@.^....(~....]r.]@r.....C...8+..<r.:............!.{....h.~`>..~1.1...<.v...
..?PK..
......o
-d..~............dragon5.out5286
PK.........o
-....\....	..
...dragon6.inMV..%!..o..@.|m.?..d.gn..F.d.f.m.....!..h.m.m.gD.......9.&.@...60.ht~.....A..-4..NA
.+H....+....J..Rl....F8..[.j.
.\.Pj.H.....G.R..v.H5g.8*....z.A............_..	|..
....{..|.h........U6..-0.9G`.....F....9N..Z.[.~.0pI.....U......g.aV;...x7U.....oG...{U.....CM.q...l..L.}..X.....*vp.@.....=]CL....f......a&.....,>..p..9N`....?..*..E..
..../..u.[..t9..GU..0.U.....{.E.N?..t...t.{..|.+$zy.....xr/j.....%^."....'..tOap.S.'O\]..=..-..a.+..*D }..<5.].(..Y..e.$.u..z_.\q~.@..W$...u."u."
04:46:18.707179 IP 202.120.2.2.50800 > 192.168.0.100.58760: Flags [.], seq 1437:2873, ack 1, win 46, options [nop,nop,TS val 3100720249 ecr 71648912], length 1436
E...0+@....v.x.....d.p.........i....P......
..<y.EF..@"_X.X...gL......^:.......[.R.
6.b..(...l*E.[ED.=.._..\..M".ZAE.. 2.{Df......b..,.ss.c
..qv......V5.Hy.D..V...$..._.D.....
.=...G..hg.n....\ZD..o0_A..d_*..
.V`....4....vv...C.]OhY...x...E...d.(.........|.*c.....V....U..N....Q..G..~..._..b<.xp...8..*.M..g....`s~....S.........._.2L...?v........*.....GB'+...N}G.(.5SLq..v..d
."CN.x....v.`....a.[.......E..-.>.....\!....n.3.....HJ..?PK..
......o
-.c..............dragon6.out543
PK........Yo
-.........
..
...dragon7.in5VI.$1..wD..O0....F..>...E.Qz..#u..r...,~.>._v..\..8....y..../N.P.G.w.....;}.>O..=.)c,r\..C..)..}..S.A.z.a..q.#q....!.c\......m...;.ao..Q1.....G.....{..6..A"L..vz^.QG..9. t#8..&O].D.	U[^....d.3]....z......j..J... ....N..Z..\..'.....W}*7 ..t.5.~..X4&GC)^q.....]a&.....2.{2...Lk.....V(..-...H.2x./.B.5.`/......X....6.......*.	G.(..7._.[...].......O:..-..=..G.fO.A|o...(\.i.I9e..E......:	 .\.7...B.h(....Nd.../.......K..@.Dp.	...@'.I.B..v.U....u.t.y...Y....$..!V......ah>...Gb../.....]....<.L...".r......j.<..R..<...H......z..).a.
..7}.]...@C.........i.....7x.5.E.......]9..\
..W........Aw..AR...R..T....0	 ......%=....\(U.99!.G...r)qo..'.\..............M....o.....X.#.U.N.V.(.......\.ZZ.....
...\W{*$YV..xhC {.Nl.....I.....=.o...w.
........H...w.( p.hR....=....N4.c....3.0Q..	..F...z.......
.e_....P.......C.2.P.U(..
...DO.z....:.........B...(.8e...!......-..3/p.K.]C*.n....).".9.,P..)P1.\..V.(x.$*..R.(..wtP .)1...a..8o8...z.l..7EA..`v..$.:@.TF.EO...*>nQ.}u.>(....%..P.c
04:46:18.707238 IP 192.168.0.100.58760 > 202.120.2.2.50800: Flags [.], ack 2873, win 32756, options [nop,nop,TS val 71649322 ecr 3100720249], length 0
E..4..@.@..Y...d.x.....p...i...{.....w.....
.EH*..<y
04:46:18.707296 IP 202.120.2.2.50800 > 192.168.0.100.58760: Flags [.], seq 2873:4309, ack 1, win 46, options [nop,nop,TS val 3100720249 ecr 71648912], length 1436
E...0,@....u.x.....d.p.....{...i.....7.....
..<y.EF..|...3vDc.%%.......k.?C.F..R.+.?..	c.J	x...........m..c7c.t....;".h.......A..."?A.....(....*&Ho..0qG.b.G.s.8...B...;..v\.R;..K..dk.^......f.@AC,i(yL....l....|.W.L.t~Mh.2..-....H.j.f(..lB.e..4...nX.rF..'..dh.Z.\O.....HD,bJ..w...PK..
.....bo
-.?..............dragon7.out20639
PK.........e.-	..u
...s
..
...dragon8.in5.K.$!.C...w........'g....c....{.eq..l..w{.........[y.
...........E....2.fC.Z.i....}......b...........qc...o.|o..u.U.~..l]..r.{.T.K...	a...\	X/...r..6.$....Mm:.|....d-.t.y..O.i.....'.D..G...<......T=..%Yn.4...i..k...g.K..B.....V!TD.yzOU..e.$yc%I...;.B./.V.s	.K5.E0.<.7.M.G...;.(_....N..8...f..9.<.(Sd.y..J.!@..+\.;J9...^/.)\..iz.	.
..\W.-........?._..V{.....vn.@..*E	0r.w.......N2..z......^(........,.V.F......p.IE.....&.NG.Q.F.H.JB.%..w..Ft`...tn......@.3.$..O.../h>q.
.......
t.5:..m..P.bs	..
	Dlu.N.....b..*...P]i.m...K)..^.YJ.ir.[..Kb...N.H`.wH..s.....n.......T...o9[...F...k8.P.G.../+......?:.m..].H...9_..
..'.k...e...:6...q..+p..M..D6$`[9.	j....y.).6Z8..2.n.../}@...MHX.;..m..j"_..4.....M&x.gd&..K.[P...b.."..'.......t

.T..(.dx.~..y..[...H_..V.q.D..	.i..8B..\.~.......
U..v...............U.Ox./...D=...T<r.KU..GB42>..|2....Sv... Q.TPG.jD./g.u.]w....zs.>Q......K....%.../.cWc*....{...v.S..@.Lz....!....1NEET.g.P 4.qr.i.S]O.J^...S....o^5.i.h|Ov..s]W.W.......N4}...2.5..Nk.	z.J........Q.O.(.Jc..+5.D)X.K....Ks
...&4n.....5.jG...BV.....E.5GK3........t...ahg..........#..A.t..y....=..9....C....E.w3..R9
S..X..1.....O7.
04:46:18.707387 IP 202.120.2.2.50800 > 192.168.0.100.58760: Flags [.], seq 4309:5745, ack 1, win 46, options [nop,nop,TS val 3100720249 ecr 71648912], length 1436
E...0-@....t.x.....d.p.........i....=m.....
..<y.EF.tJ..w..
N.....8]...^.y.1l)I..W0...iQ.d.L.....L.<:...Z...JPr...V..P..{.-........e.MUG.r.RWI.\....b.FJ......|.O7q..3.......&.w.,k.i....0.[.[Iz..0.9)%..{rT...g.......g........PK..
.......
-{i..	...	.......dragon8.out2575127
PK.........p
-............
...dragon9.in5....1......4..o..S&z....&.G.P....h...?.....4.X........h.....?..v.....v.;..l.ex.[.E_>Eo..V...{.m....b.so..........<....>.qZ.6.J^....3n.|-.(/.[.................}...X.Y.s.{7A.Un.$..F..1n..m.^......"..;......fN...Qa.z.;......e.</.....m.#...L..H...`..T...!^Wlq..........Vf..{N/....n..8
........p.k...........b.b@......mo....:..G[...*.5%..%...y.E.7....p.(T.E.....z......#!#..0.5..l'...n.dV..q.f.^...P)..l.H|.
...K%_..../....F.'*.....9.r.Q.vl.3....7_...q...:^.....'].-.[@2=.V._..../..M....%f.....xwVd.\e6.P...+/MsmFjz..}~(.........+..~U.?|.MY..._......}...^.j.e...n.qb...H4.n..A.-@<.|..t.....r........Jb..q,.^.D..2...M{..	....-:............?.1..	?..>d}Z.j...._..#r..B.w..W+..}..Q.d6.(.[..B.h.=T9}.r...X.......(....|.Y{.....A..p.....8x......=...R.^...v.)O.'DP....z....S....2.B.GV.
..q^	%...jl.yWI.#M...	b.,..h.......x......W.....yS..d..E.X(i).,....bP.Eh.T..dmE.I..nO.a7..9:...nI.M.5.0..X
...n^gF. 5]......+_....8....&...q.}#...{9....>..jYC..7K6...p.>...R.Z.]S..
.........ia.(.....=\..U...WT.......3..B.He...o..b8......G....f...1......3.....8.....G$J...
....	%..G....J. .o........^$2S...A...R...}.)...
.....X..'Z.u.tK..9.........?.....P..9....S..2.@.R...Q...m04.V..E..SU..3.1>.NPD..
04:46:18.707428 IP 192.168.0.100.58760 > 202.120.2.2.50800: Flags [.], ack 5745, win 32734, options [nop,nop,TS val 71649323 ecr 3100720249], length 0
E..4..@.@..<...d.x.....p...i.."......T.....
.EH+..<y
04:46:18.707496 IP 202.120.2.2.50800 > 192.168.0.100.58760: Flags [.], seq 5745:7181, ack 1, win 46, options [nop,nop,TS val 3100720249 ecr 71648912], length 1436
E...0.@....s.x.....d.p...."....i.....M.....
..<y.EF...(.<.8.......W8.QM.K.H.fY.Je.G....h.^..dJ...].YrP.<....*.....({|xf8..:...*=..]....;..2...Fg....L
......0\5.2J.J.a.z........U~..`N...D1......6.J.z....[
..._..K...w"/..1,0...........Z_V...f....bf.tZ8....4T..t....&.j*...F.,..T5ko.1:....1..aQ.F....F`R..ijg..y\..R...)-....S:?[....(S......7...m.c............W.c..Z...k..B..2]PK..BZ.I..0.^%.E-.........".E...L.\.
....VB@I)]..g&.m.G{..5y.cw..WM....&P.&..j.V....#$.7$.8.v..u	...XQW....9.?K:...3....x....<)_.m..7..kk....M.,O...u..:.-jP..9.7.Q4.SD]..%.,...UN??t...*.....bp.....TY..n..
..z..EK.....#....T..J.?e2>.C..!..|.......$.*.A.... ......,..DBo..u.....r...t.2n....PK..
......p
-................dragon9.out39384
PK........{p
-....&...........dragon10.in=.[nm!.C.+u..a'..?....+U*g.!qlC...-...'.........m.1.{........>.nw...v...i......d.l..0..`... \x0.JE...a..b...b.$~.i..n......Bo.h;<P.N..>up...d.?-.c.0.._K.G..>e....|{...&z:.n...u\.m.....2...N..6..L...e.m\....e."...Jl.?=...B..W8f.....:...)<.....<......5.-.K..V(.$..E...sz....>.1..pr... =.....9(....6..EhT.......@......	...... d...
...h...
...LHA...'5.\......|..6.X.6.....%.A!.zh..q......47*Ax;.H.*>...r>.....$....Wq+8..Dg@..2.Tw...V...B.0.w.1)d..z_.4.}..f|aNK._.4....Ck._k..$Q.....o;....R(G~....Sq,.E.5)...7r-%.??!.QdR....fT............. =.......]...p`..[..T.. M..J-...A.....(t..a.A..Fi....b.S]..B.n1^....
E.......nF....@..&....=(..$....G.\...D..L>R
d./.i....(.H........f.E.......:.j.ow..._3...=._.&....-.W".N.Rd..@.G:.J...Y2..o-..wm_+B..g..
04:46:18.707615 IP 202.120.2.2.50800 > 192.168.0.100.58760: Flags [.], seq 7181:8617, ack 1, win 46, options [nop,nop,TS val 3100720249 ecr 71648912], length 1436
E...0/@....r.x.....d.p....(O...i....)}.....
..<y.EF...WC...8p..( .x........lM.....(...*.]e..N+.
.@....gEs.^..Ey.C.7X....,W...-.c....8.z,Vb
V.............1n.\.c
...7....Qj...L(........6o]E....... ./...V%..zT. .0M...F!..C/.....k..c...=d5-e..v....Z...........|n...v.............JF.P.Z.g.e..L<U[...>.P4=+(.e7......R9..Mj..8EB?.z./5.. 
u.;.....O.K...ui......%*e.G.0=..8.J.20..$..%.......%..[.o(...0
.....V.[...(.w.'V..h.b..sv7P..a.g/V.}.......+..2O...z./..)f.4W.&..*..$^.@.*........z%..8...4q
.{.5.z..?=.p.W.F..:.Q...i....=.$%...z..'.b..S<. .B.Ru8.z..c.%.<.gz.W.W......+...<U...+$UG-Vp*VQwH.)..F=%...Pt..(J.............lb.~.r$5.>>..
....PK..
.....vp
-.{:T............dragon10.out140
PK........+..,/1../...=...
...dragon1.in...
.0......<.....d..W.n..7~2d.E........V......PK..
........,..Q.............dragon1.out0
PK.........n
-3...........
...dragon2.in3V0R0..2.R. .X.....PK..
.....(n
-................dragon2.out-1
PK........p_.,M..^........
...dragon3.in-..
.1.B.#M...O.I.ol..=...8.B>...p..RU.Ca.I..
S3.'...qia....n8j.J.-.KN2....9'.....t.l.8............8<..9A....B..^j.....O...X.bjs.)...H.4...PK..
........,),.k............dragon3.out88
PK.........n
-...,........
...dragon4.in%S.
.1..GJ..`n.....|..k..y.O*...........e-OCR=q.A.e...R2...OIK..q...M^[.yv......h...!..l.....d..9d"..\...F|.B../m......iW.?....].'Y.~3........./.K................]=.......1.vp
V....H......U:z...$...t..l...q....xV.../.j..[.So....;,@..%...UI-...O%.
.Y`v.Gk.vH..$...q
...>Z.s..~ww..}I!.s..$
.....b~}6$.5.B...3}Ve 
04:46:18.707636 IP 192.168.0.100.58760 > 202.120.2.2.50800: Flags [.], ack 8617, win 32711, options [nop,nop,TS val 71649323 ecr 3100720249], length 0
E..4.&@.@......d.x.....p...i..-......3.....
.EH+..<y
04:46:18.707706 IP 202.120.2.2.50800 > 192.168.0.100.58760: Flags [FP.], seq 8617:9915, ack 1, win 46, options [nop,nop,TS val 3100720249 ecr 71648912], length 1298
E..F00@......x.....d.p....-....i...........
..<y.EF..`Mp.w]...0._{..N...jM.....W.......h..$..s.l...
G..4+ .)..G.......k^A..^IjP>t.4.....'.s..2...!v...FD:o.....__..~YI6
...iZ......f....L^..n.......PK....
......n
-...................... .......dragon4.outPK...........o
-4i.m........
......... ...0...dragon5.inPK....
......o
-d..~.................. ...f...dragon5.outPK...........o
-....\....	..
......... .......dragon6.inPK....
......o
-.c.................... .......dragon6.outPK..........Yo
-.........
..
......... ...G...dragon7.inPK....
.....bo
-.?.................... .......dragon7.outPK...........e.-	..u
...s
..
......... ...K...dragon8.inPK....
.......
-{i..	...	............. .......dragon8.outPK...........p
-............
......... .......dragon9.inPK....
......p
-...................... .......dragon9.outPK..........{p
-....&................. .......dragon10.inPK....
.....vp
-.{:T.................. ...P...dragon10.outPK..........+..,/1../...=...
......... .......dragon1.inPK....
........,..Q................... .......dragon1.outPK...........n
-3...........
......... .......dragon2.inPK....
.....(n
-...................... ...=...dragon2.outPK..........p_.,M..^........
......... ...j...dragon3.inPK....
........,),.k.................. .... ..dragon3.outPK...........n
-...,........
......... ...J ..dragon4.inPK..........l...8"....
04:46:18.707726 IP 192.168.0.100.58760 > 202.120.2.2.50800: Flags [.], ack 9916, win 32701, options [nop,nop,TS val 71649323 ecr 3100720249], length 0
E..4Y.@.@.S....d.x.....p...i..2......*.....
.EH+..<y
04:46:18.711024 IP 192.168.0.100.58760 > 202.120.2.2.50800: Flags [.], ack 9916, win 32768, options [nop,nop,TS val 71649326 ecr 3100720249], length 0
E..4E.@.@.gK...d.x.....p...i..2............
.EH...<y
04:46:18.711216 IP 192.168.0.100.58760 > 202.120.2.2.50800: Flags [F.], seq 1, ack 9916, win 32768, options [nop,nop,TS val 71649326 ecr 3100720249], length 0
E..4.R@.@......d.x.....p...i..2............
.EH...<y
04:46:19.112550 IP 202.120.2.2.50800 > 192.168.0.100.58760: Flags [.], ack 2, win 46, options [nop,nop,TS val 3100720661 ecr 71649326], length 0
E..401@......x.....d.p....2....j...........
..>..EH.


--- VIVEK seems like passive mode stops here



04:46:19.188619 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 727:750, ack 75, win 46, options [nop,nop,TS val 3100720828 ecr 71649320], length 23
E..K..@......x.....d......=.(..............
..>..EH(226 Transfer complete

04:46:19.188748 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 750, win 8210, options [nop,nop,TS val 71649802 ecr 3100720828], length 0
E..4..@.@......d.x......(.....=... .U......
.EJ
..>.
04:46:23.778790 IP 192.168.0.100.63887 > 192.168.0.1.53: 63955+ TXT? time.apple.com. (32)
E..<.p....P....d.......5.(...............time.apple.com.....
04:46:23.789841 IP 192.168.0.1.53 > 192.168.0.100.63887: 63955 1/0/0 TXT "ntp minpoll 9 maxpoll 12 iburst" (76)
E..hGO@............d.5...TE..............time.apple.com.............
.. .ntp minpoll 9 maxpoll 12 iburst
04:46:24.693479 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 69:81, ack 761, win 8209, options [nop,nop,TS val 71655299 ecr 3100697034], length 12
E..@+u@.@......d.x........&y.cJ8.. ........
.E_.....CWD phase1

04:46:25.044321 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [.], ack 81, win 46, options [nop,nop,TS val 3100726642 ecr 71655299], length 0
E..4..@...Ee.x.....d.....cJ8..&.....)~.....
..Ur.E_.
04:46:25.044422 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 761:789, ack 81, win 46, options [nop,nop,TS val 3100726644 ecr 71655299], length 28
E..P..@...EH.x.....d.....cJ8..&.....v......
..Ut.E_.250 CWD command successful

04:46:25.044479 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 789, win 8207, options [nop,nop,TS val 71655648 ecr 3100726644], length 0
E..4..@.@......d.x........&..cJT.. ..".....
.E`...Ut
04:46:25.044727 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 81:86, ack 789, win 8207, options [nop,nop,TS val 71655648 ecr 3100726644], length 5
E..9..@.@..=...d.x........&..cJT.. .i......
.E`...UtPWD

04:46:25.453322 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 789:829, ack 86, win 46, options [nop,nop,TS val 3100726991 ecr 71655648], length 40
E..\..@...E;.x.....d.....cJT..&............
..V..E`.257 "/phase1" is the current directory

04:46:25.453386 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 829, win 8205, options [nop,nop,TS val 71656056 ecr 3100726991], length 0
E..4..@.@..S...d.x........&..cJ|.. 
.......
.Ebx..V.
04:46:25.453647 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 86:92, ack 829, win 8205, options [nop,nop,TS val 71656056 ecr 3100726991], length 6
E..:..@.@......d.x........&..cJ|.. 
TT.....
.Ebx..V.PASV

---- VIVEK start passive

04:46:25.862500 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 829:879, ack 92, win 46, options [nop,nop,TS val 3100727399 ecr 71656056], length 50
E..f..@...E0.x.....d.....cJ|..&............
..Xg.Ebx227 Entering Passive Mode (202,120,2,2,229,150).

04:46:25.862591 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 879, win 8202, options [nop,nop,TS val 71656464 ecr 3100727399], length 0
E..4O\@.@.]....d.x........&..cJ... 
.......
.Ed...Xg
04:46:25.864439 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 92:98, ack 879, win 8202, options [nop,nop,TS val 71656465 ecr 3100727399], length 6
E..:!$@.@......d.x........&..cJ... 
T......
.Ed...XgLIST

04:46:25.864487 IP 192.168.0.100.58761 > 202.120.2.2.58774: Flags [S], seq 677287987, win 65535, options [mss 1460,nop,wscale 7,nop,nop,TS val 71656465 ecr 0,sackOK,eol], length 0
E..@_.@.@.M....d.x......(^.3.........k.............
.Ed.........
04:46:26.271664 IP 202.120.2.2.58774 > 192.168.0.100.58761: Flags [S.], seq 347374538, ack 677287988, win 5792, options [mss 1448,sackOK,TS val 3100727808 ecr 71656465,nop,wscale 7], length 0
E..<..@....5.x.....d........(^.4.....{.........
..Z..Ed.....
04:46:26.271773 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [.], ack 98, win 46, options [nop,nop,TS val 3100727848 ecr 71656465], length 0
E..4..@...Ea.x.....d.....cJ...&............
..Z(.Ed.
04:46:26.271802 IP 192.168.0.100.58761 > 202.120.2.2.58774: Flags [.], ack 1, win 32769, options [nop,nop,TS val 71656871 ecr 3100727808], length 0
E..4..@.@..i...d.x......(^.4.........C.....
.Ee...Z.
04:46:26.683343 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 879:933, ack 98, win 46, options [nop,nop,TS val 3100728214 ecr 71656465], length 54
E..j..@...E*.x.....d.....cJ...&.....-......
..[..Ed.150 Opening ASCII mode data connection for file list

04:46:26.683471 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 933, win 8198, options [nop,nop,TS val 71657280 ecr 3100728214], length 0
E..4..@.@......d.x........&..cJ... ........
.Eg@..[.
04:46:26.683950 IP 202.120.2.2.58774 > 192.168.0.100.58761: Flags [P.], seq 1:230, ack 1, win 46, options [nop,nop,TS val 3100728219 ecr 71656871], length 229
E....]@......x.....d........(^.4....&......
..[..Ee.-rw-r--r--   1 shiningmoon 6000         2283 Nov 30  2011 ARP.java
-rw-r--r--   1 shiningmoon 6000         3138 Nov 30  2011 L2Switch.java
-rw-r--r--   1 shiningmoon 6000         2932 Nov 30  2011 StoreForwardingDatalink.java

04:46:26.683955 IP 202.120.2.2.58774 > 192.168.0.100.58761: Flags [F.], seq 230, ack 1, win 46, options [nop,nop,TS val 3100728219 ecr 71656871], length 0
E..4.^@......x.....d........(^.4....E......
..[..Ee.
04:46:26.684032 IP 192.168.0.100.58761 > 202.120.2.2.58774: Flags [.], ack 230, win 32768, options [nop,nop,TS val 71657280 ecr 3100728219], length 0
E..4.L@.@......d.x......(^.4.........+.....
.Eg@..[.
04:46:26.684032 IP 192.168.0.100.58761 > 202.120.2.2.58774: Flags [.], ack 231, win 32768, options [nop,nop,TS val 71657280 ecr 3100728219], length 0
E..4..@.@..M...d.x......(^.4.........*.....
.Eg@..[.
04:46:26.684379 IP 192.168.0.100.58761 > 202.120.2.2.58774: Flags [F.], seq 1, ack 231, win 32768, options [nop,nop,TS val 71657280 ecr 3100728219], length 0
E..49.@.@.s....d.x......(^.4.........).....
.Eg@..[.
04:46:27.090072 IP 202.120.2.2.58774 > 192.168.0.100.58761: Flags [.], ack 2, win 46, options [nop,nop,TS val 3100728628 ecr 71657280], length 0
E..4._@......x.....d........(^.5....Bc.....
..]4.Eg@
04:46:27.090131 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 933:956, ack 98, win 46, options [nop,nop,TS val 3100728629 ecr 71657280], length 23
E..K..@...EH.x.....d.....cJ...&.....MW.....
..]5.Eg@226 Transfer complete





--- VIVEK end passive






04:46:27.090193 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 956, win 8197, options [nop,nop,TS val 71657686 ecr 3100728629], length 0
E..4..@.@..}...d.x........&..cJ... ........
.Eh...]5
04:46:31.350352 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 75:88, ack 750, win 8210, options [nop,nop,TS val 71661944 ecr 3100720828], length 13
E..A..@.@..v...d.x......(.....=... .X......
.Eyx..>.CWD /phase1

04:46:31.351188 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [S], seq 2119708603, win 65535, options [mss 1460,nop,wscale 4,nop,nop,TS val 71661944 ecr 0,sackOK,eol], length 0
E..@..@.@......d.x......~X/........................
.Eyx........
04:46:31.692021 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [.], ack 88, win 46, options [nop,nop,TS val 3100733294 ecr 71661944], length 0
E..4..@......x.....d......=.(..............
..on.Eyx
04:46:31.692147 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 750:778, ack 88, win 46, options [nop,nop,TS val 3100733296 ecr 71661944], length 28
E..P..@......x.....d......=.(.......c......
..op.Eyx250 CWD command successful

04:46:31.692151 IP 202.120.2.2.21 > 192.168.0.100.58762: Flags [S.], seq 352023725, ack 2119708604, win 5792, options [mss 1448,sackOK,TS val 3100733298 ecr 71661944,nop,wscale 7], length 0
E..<..@....5.x.....d......t.~X/......v.........
..or.Eyx....
04:46:31.692216 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 778, win 8208, options [nop,nop,TS val 71662285 ecr 3100733296], length 0
E..4o4@.@.>	...d.x......(.....>... ..A.....
.Ez...op
04:46:31.692261 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [.], ack 1, win 8257, options [nop,nop,TS val 71662285 ecr 3100733298], length 0
E..4<F@.@.p....d.x......~X/...t... A.A.....
.Ez...or
04:46:31.692433 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 88:93, ack 778, win 8208, options [nop,nop,TS val 71662285 ecr 3100733296], length 5
E..9..@.@......d.x......(.....>... .U......
.Ez...opPWD

04:46:32.101221 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 778:818, ack 93, win 46, options [nop,nop,TS val 3100733641 ecr 71662285], length 40
E..\..@......x.....d......>.(..............
..p..Ez.257 "/phase1" is the current directory

04:46:32.101284 IP 202.120.2.2.21 > 192.168.0.100.58762: Flags [P.], seq 1:7, ack 1, win 46, options [nop,nop,TS val 3100733652 ecr 71662285], length 6
E..:.f@......x.....d......t.~X/......z.....
..p..Ez.220-

04:46:32.101337 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 818, win 8205, options [nop,nop,TS val 71662693 ecr 3100733641], length 0
E..4..@.@......d.x......(.....>0.. 
.&.....
.E|e..p.
04:46:32.101385 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [.], ack 7, win 8256, options [nop,nop,TS val 71662693 ecr 3100733652], length 0
E..4a.@.@.K....d.x......~X/...t... @.B.....
.E|e..p.
04:46:32.101927 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 93:101, ack 818, win 8205, options [nop,nop,TS val 71662693 ecr 3100733641], length 8
E..<<m@.@.p....d.x......(.....>0.. 
.-.....
.E|e..p.TYPE A

04:46:32.357095 IP 192.168.0.100.58705 > 115.239.210.151.80: Flags [R.], seq 1, ack 1, win 16384, length 0
E..(..@.@..+...ds....Q.Pc.E..n..P.@.J...
04:46:32.406322 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 818:837, ack 101, win 46, options [nop,nop,TS val 3100734048 ecr 71662693], length 19
E..G..@......x.....d......>0(..............
..r`.E|e200 Type set to A

04:46:32.406404 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 837, win 8204, options [nop,nop,TS val 71662997 ecr 3100734048], length 0
E..4.Y@.@......d.x......(.....>C.. ..E.....
.E}...r`
04:46:32.406523 IP 202.120.2.2.21 > 192.168.0.100.58762: Flags [P.], seq 7:418, ack 1, win 46, options [nop,nop,TS val 3100734048 ecr 71662693], length 411
E....g@....;.x.....d......t.~X/......7.....
..r`.E|e220-  -- Welcome to Portal of Shanghai Jiao Tong University --
220-  -You are number 23 of 1200 allowed users.
220-  -Local time is Mon Feb 24 16:46:31 2014 now.
220-  -This is a private system - No anonymous login allowed
220-  -You will be disconnected after 15 minutes of inactivity.
220-  ---------------------------------------------------------
220 ProFTPD 1.3.2 Server (public_SJTU) [202.120.2.2]

04:46:32.406611 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [.], ack 418, win 8230, options [nop,nop,TS val 71662997 ecr 3100734048], length 0
E..4
I@.@......d.x......~X/...vO.. &.......
.E}...r`
04:46:32.406830 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 101:107, ack 837, win 8204, options [nop,nop,TS val 71662997 ecr 3100734048], length 6
E..:.r@.@......d.x......(.....>C.. .=......
.E}...r`PASV

04:46:32.406895 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [P.], seq 1:19, ack 418, win 8230, options [nop,nop,TS val 71662997 ecr 3100734048], length 18
E..F..@.@..Z...d.x......~X/...vO.. &.......
.E}...r`USER shiningmoon

04:46:32.816987 IP 202.120.2.2.21 > 192.168.0.100.58762: Flags [.], ack 19, win 46, options [nop,nop,TS val 3100734352 ecr 71662997], length 0
E..4.h@......x.....d......vO~X/............
..s..E}.
04:46:32.817580 IP 202.120.2.2.21 > 192.168.0.100.58762: Flags [P.], seq 418:457, ack 19, win 46, options [nop,nop,TS val 3100734354 ecr 71662997], length 39
E..[.i@......x.....d......vO~X/............
..s..E}.331 Password required for shiningmoon

04:46:32.817649 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [.], ack 457, win 8228, options [nop,nop,TS val 71663406 ecr 3100734354], length 0
E..43.@.@.y_...d.x......~X/...vv.. $.......
.E....s.




--- START PASSIVE




04:46:32.817761 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 837:887, ack 107, win 46, options [nop,nop,TS val 3100734354 ecr 71662997], length 50
E..f..@....u.x.....d......>C(........*.....
..s..E}.227 Entering Passive Mode (202,120,2,2,195,122).

04:46:32.817846 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 887, win 8201, options [nop,nop,TS val 71663406 ecr 3100734354], length 0
E..4..@.@......d.x......(.....>u.. 	.E.....
.E....s.
04:46:32.817865 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [P.], seq 19:32, ack 457, win 8228, options [nop,nop,TS val 71663406 ecr 3100734354], length 13
E..A..@.@......d.x......~X/...vv.. $.......
.E....s.PASS public

04:46:32.818674 IP 192.168.0.100.58763 > 202.120.2.2.50042: Flags [S], seq 1213956715, win 65535, options [mss 1460,nop,wscale 7,nop,nop,TS val 71663407 ecr 0,sackOK,eol], length 0
E..@.R@.@......d.x.....zH[.k.........2.............
.E./........
04:46:32.818798 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 107:122, ack 887, win 8201, options [nop,nop,TS val 71663407 ecr 3100734354], length 15
E..C .@.@..#...d.x......(.....>u.. 	.......
.E./..s.RETR ARP.java

04:46:33.226211 IP 202.120.2.2.50042 > 192.168.0.100.58763: Flags [S.], seq 359805400, ack 1213956716, win 5792, options [mss 1448,sackOK,TS val 3100734764 ecr 71663407,nop,wscale 7], length 0
E..<..@....5.x.....d.z...r1.H[.l....7J.........
..u,.E./....
04:46:33.226273 IP 192.168.0.100.58763 > 202.120.2.2.50042: Flags [.], ack 1, win 32769, options [nop,nop,TS val 71663813 ecr 3100734764], length 0
E..4.B@.@......d.x.....zH[.l.r1............
.E....u,
04:46:33.226762 IP 202.120.2.2.21 > 192.168.0.100.58762: Flags [P.], seq 457:495, ack 32, win 46, options [nop,nop,TS val 3100734786 ecr 71663406], length 38
E..Z.j@......x.....d......vv~X/......s.....
..uB.E..230-  Quotas on: 17.71 MB/500.00 MB 

04:46:33.226764 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [.], ack 122, win 46, options [nop,nop,TS val 3100734805 ecr 71663407], length 0
E..4..@......x.....d......>u(.......	N.....
..uU.E./
04:46:33.226806 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [.], ack 495, win 8226, options [nop,nop,TS val 71663813 ecr 3100734786], length 0
E..4t.@.@.8x...d.x......~X/...v... ".......
.E....uB
04:46:33.635392 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 887:953, ack 122, win 46, options [nop,nop,TS val 3100735169 ecr 71663407], length 66
E..v..@....c.x.....d......>u(........).....
..v..E./150 Opening ASCII mode data connection for ARP.java (2283 bytes)

04:46:33.635522 IP 202.120.2.2.21 > 192.168.0.100.58762: Flags [P.], seq 495:527, ack 32, win 46, options [nop,nop,TS val 3100735172 ecr 71663813], length 32
E..T.k@......x.....d......v.~X/......>.....
..v..E..230 User shiningmoon logged in

04:46:33.635541 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 953, win 8197, options [nop,nop,TS val 71664221 ecr 3100735169], length 0
E..4i
@.@.D0...d.x......(.....>... ........
.E.]..v.
04:46:33.635610 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [.], ack 527, win 8224, options [nop,nop,TS val 71664221 ecr 3100735172], length 0
E..4i @.@.D....d.x......~X/...v...  .R.....
.E.]..v.
04:46:33.636299 IP 202.120.2.2.50042 > 192.168.0.100.58763: Flags [.], seq 1:1437, ack 1, win 46, options [nop,nop,TS val 3100735196 ecr 71663813], length 1436
E...G.@......x.....d.z...r1.H[.l...........
..v..E..package tenet.protocol.network.arp;

import tenet.protocol.IProtocol;
import tenet.protocol.interrupt.InterruptObject;
import tenet.protocol.interrupt.InterruptParam;
import tenet.protocol.network.INetworkLayer;
import tenet.util.pattern.serviceclient.IClient;
import tenet.util.pattern.serviceclient.IRegistryableService;
import tenet.util.pattern.serviceclient.IService;


//The MAC conflict should throw the 0x80000500 to the upper layer.
public class ARP extends InterruptObject implements INetworkLayer,
		IRegistryableService<Integer> {

	

	public ARP() {
		//The initialization
		
	}
	

	
	public void send(int HTYPE, byte[] hardwareAddr, int PTYPE, byte[] protocolAddr) {
		//The basic function that you can send a arp package to the others.
		//SEther's HTYPE is 1, IPv4's PTYPE is 0x0800 as default
		//Some different PTYPE will appear in the verification
	}


	public byte[] getHardwareAddress(int PTYPE, byte[] protocolAddr) {
		//The mapping you have maintained will be used by some other protocol.
		//The higher layer will use it to get the mac.

	}

	@Override
	protected void interruptHandle(int signal, InterruptParam param) {
		// This is the most important function in ARP.
		// Ths signals may be caused by the IDataLinkLayer and yourself.
		// IDataLinkLayer.INT_FRAME_RECEIVE & IDataLinkLayer.INT_FRAME_TRANSMIT are the important signals. 
		
	}

	@Override
	public 
04:46:33.636303 IP 202.120.2.2.50042 > 192.168.0.100.58763: Flags [P.], seq 1437:2389, ack 1, win 46, options [nop,nop,TS val 3100735196 ecr 71663813], length 952
E...G.@....k.x.....d.z...r7uH[.l...........
..v..E..void dump() {
		// TODO This is used for the debugging. You may use it to export something iteratively.	

	}

	@Override
	public String getIdentify() {
		return null;
	}

	@Override
	public String getName() {
		return null;		
	}

	@Override
	public void registryClient(IClient<Integer> client) {
		//A higher layer client may transfer it.

	}

	@Override
	public void unregistryClient(IClient<Integer> client) {
		
	}

	@Override
	public void unregistryClient(Integer id) {

	}

	@Override
	public void attachTo(IService service) {
		// TODO You will attachTo a lower layer in the Protocol Stack. 
		
	}

	@Override
	public void detachFrom(IService service) {
		
	}

	@Override
	public Integer getUniqueID() {
		// TODO return the Protocol ID.
		
	}

	@Override
	public void setUniqueID(Integer id) {
		// TODO Set the Protocol ID.		
	}


}

class ArpFrame {
	// the ARP frame data struct. 

}
04:46:33.636304 IP 202.120.2.2.50042 > 192.168.0.100.58763: Flags [F.], seq 2389, ack 1, win 46, options [nop,nop,TS val 3100735196 ecr 71663813], length 0
E..4G.@....".x.....d.z...r;-H[.l....o......
..v..E..
04:46:33.636371 IP 192.168.0.100.58763 > 202.120.2.2.50042: Flags [.], ack 2389, win 32751, options [nop,nop,TS val 71664221 ecr 3100735196], length 0
E..4..@.@..F...d.x.....zH[.l.r;-...........
.E.]..v.
04:46:33.636371 IP 192.168.0.100.58763 > 202.120.2.2.50042: Flags [.], ack 2390, win 32751, options [nop,nop,TS val 71664221 ecr 3100735196], length 0
E..4..@.@......d.x.....zH[.l.r;............
.E.]..v.
04:46:33.636978 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [P.], seq 32:45, ack 527, win 8224, options [nop,nop,TS val 71664222 ecr 3100735172], length 13
E..A.W@.@......d.x......~X/...v...  %......
.E.^..v.CWD /phase1

04:46:33.642307 IP 192.168.0.100.58763 > 202.120.2.2.50042: Flags [F.], seq 1, ack 2390, win 32768, options [nop,nop,TS val 71664227 ecr 3100735196], length 0
E..4.y@.@......d.x.....zH[.l.r;......o.....
.E.c..v.
04:46:34.044268 IP 202.120.2.2.21 > 192.168.0.100.58762: Flags [P.], seq 527:555, ack 45, win 46, options [nop,nop,TS val 3100735585 ecr 71664222], length 28
E..P.l@......x.....d......v.~X/....._......
..xa.E.^250 CWD command successful

04:46:34.044330 IP 202.120.2.2.50042 > 192.168.0.100.58763: Flags [.], ack 2, win 46, options [nop,nop,TS val 3100735587 ecr 71664227], length 0
E..4G.@....!.x.....d.z...r;.H[.m....l......
..xc.E.c
04:46:34.044384 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [.], ack 555, win 8222, options [nop,nop,TS val 71664628 ecr 3100735585], length 0
E..4..@.@......d.x......~X/...v... ........
.E....xa
04:46:34.045065 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [P.], seq 45:53, ack 555, win 8222, options [nop,nop,TS val 71664628 ecr 3100735585], length 8
E..<l.@.@.@....d.x......~X/...v... ........
.E....xaTYPE A

04:46:34.053021 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 953:976, ack 122, win 46, options [nop,nop,TS val 3100735695 ecr 71664221], length 23
E..K..@......x.....d......>.(.......6z.....
..x..E.]226 Transfer complete





--- VIVEK end passive mode







04:46:34.053117 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 976, win 8196, options [nop,nop,TS val 71664636 ecr 3100735695], length 0
E..4..@.@..X...d.x......(.....>... ........
.E....x.
04:46:34.453134 IP 202.120.2.2.21 > 192.168.0.100.58762: Flags [P.], seq 555:574, ack 53, win 46, options [nop,nop,TS val 3100735992 ecr 71664628], length 19
E..G.m@......x.....d......v.~X/......u.....
..y..E..200 Type set to A

04:46:34.453218 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [.], ack 574, win 8221, options [nop,nop,TS val 71665036 ecr 3100735992], length 0
E..4..@.@......d.x......~X/...v... ........
.E....y.
04:46:34.453335 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [P.], seq 53:59, ack 574, win 8221, options [nop,nop,TS val 71665036 ecr 3100735992], length 6
E..:c.@.@.J,...d.x......~X/...v... .;......
.E....y.PASV






--- START passive






04:46:34.862368 IP 202.120.2.2.21 > 192.168.0.100.58762: Flags [P.], seq 574:624, ack 59, win 46, options [nop,nop,TS val 3100736401 ecr 71665036], length 50
E..f.n@......x.....d......v.~X/......>.....
..{..E..227 Entering Passive Mode (202,120,2,2,151,234).

04:46:34.862449 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [.], ack 624, win 8218, options [nop,nop,TS val 71665444 ecr 3100736401], length 0
E..4..@.@......d.x......~X/...w... ..H.....
.E.$..{.
04:46:34.864297 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [P.], seq 59:79, ack 624, win 8218, options [nop,nop,TS val 71665445 ecr 3100736401], length 20
E..H.,@.@......d.x......~X/...w... ..,.....
.E.%..{.RETR L2Switch.java

04:46:34.864348 IP 192.168.0.100.58764 > 202.120.2.2.38890: Flags [S], seq 395781206, win 65535, options [mss 1460,nop,wscale 7,nop,nop,TS val 71665445 ecr 0,sackOK,eol], length 0
E..@..@.@......d.x........$V........d..............
.E.%........
04:46:35.272473 IP 202.120.2.2.38890 > 192.168.0.100.58764: Flags [S.], seq 370504769, ack 395781207, win 5792, options [mss 1448,sackOK,TS val 3100736809 ecr 71665445,nop,wscale 7], length 0
E..<..@....5.x.....d......tA..$W...............
..}).E.%....
04:46:35.272552 IP 192.168.0.100.58764 > 202.120.2.2.38890: Flags [.], ack 1, win 32769, options [nop,nop,TS val 71665853 ecr 3100736809], length 0
E..4..@.@. g...d.x........$W..tB....bz.....
.E....})
04:46:35.272859 IP 202.120.2.2.21 > 192.168.0.100.58762: Flags [.], ack 79, win 46, options [nop,nop,TS val 3100736849 ecr 71665445], length 0
E..4.o@......x.....d......w.~X0
.....`.....
..}Q.E.%
04:46:35.680912 IP 202.120.2.2.21 > 192.168.0.100.58762: Flags [P.], seq 624:695, ack 79, win 46, options [nop,nop,TS val 3100737215 ecr 71665445], length 71
E..{.p@......x.....d......w.~X0
...........
..~..E.%150 Opening ASCII mode data connection for L2Switch.java (3138 bytes)

04:46:35.680986 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [.], ack 695, win 8213, options [nop,nop,TS val 71666261 ecr 3100737215], length 0
E..4..@.@..d...d.x......~X0
..wd.. ........
.E.U..~.
04:46:35.681901 IP 202.120.2.2.38890 > 192.168.0.100.58764: Flags [.], seq 1:1437, ack 1, win 46, options [nop,nop,TS val 3100737227 ecr 71665853], length 1436
E...
.@......x.....d......tB..$W...........
..~..E..package tenet.node.l2switch;

import java.util.Collection;
import java.util.HashMap;
import java.util.PriorityQueue;

import tenet.core.Simulator;
import tenet.node.INode;
import tenet.protocol.datalink.IDataLinkLayer;
import tenet.protocol.datalink.MediumAddress;
import tenet.protocol.datalink.SEther.SimpleEthernetDatalink;
import tenet.protocol.interrupt.InterruptObject;
import tenet.protocol.interrupt.InterruptParam;
import tenet.util.pattern.serviceclient.IClient;

public class L2Switch extends InterruptObject implements INode {

	public class MACWithTimestamp implements Comparable<MACWithTimestamp> {

		public Double m_time;
		public MediumAddress m_mac;

		public MACWithTimestamp(Double m_time, MediumAddress m_mac) {
			super();
			this.m_time = m_time;
			this.m_mac = m_mac;
		}

		@Override
		public int compareTo(MACWithTimestamp arg0) {
			return m_time.compareTo(arg0.m_time);
		}

	}

	protected final static int TIMER = 0x00000001;

	/**
	 * ......................SimpleEthernetDatalink......
	 */
	public HashMap<MediumAddress, SimpleEthernetDatalink> m_datalinks;

	/**
	 * ..........................,..MAC..
	 */
	public HashMap<MediumAddress, SimpleEthernetDatalink> m_macport_map;
	
	public PriorityQueue<MACWithTimestamp> m_timeout;
	protected boolean m_state = false;

	public L2Switch() {
		super();
		wait(TIMER, 1.0); // .............................
04:46:35.682006 IP 202.120.2.2.38890 > 192.168.0.100.58764: Flags [.], seq 1437:2873, ack 1, win 46, options [nop,nop,TS val 3100737227 ecr 71665853], length 1436
E...
.@......x.....d......y...$W....
F.....
..~..E.....
		m_datalinks = new HashMap<MediumAddress, SimpleEthernetDatalink>();
		m_macport_map = new HashMap<MediumAddress, SimpleEthernetDatalink>();
		m_timeout = new PriorityQueue<MACWithTimestamp>();
	}

	@Override
	public void disable() {
		if (!m_state)
			return;
		for (IDataLinkLayer iface : m_datalinks.values())
			iface.disable();
		m_state = false;
	}

	@Override
	public void dump() {

	}

	@Override
	public void enable() {
		if (m_state)
			return;
		for (IDataLinkLayer iface : m_datalinks.values())
			iface.enable();
		m_state = true;
	}

	/**
	 * ....mac..........................SimpleEthernetDatalink
	 */
	public SimpleEthernetDatalink getDatalink(MediumAddress mac) {
		return m_datalinks.get(mac);
	}

	/**
	 * ......................SimpleEthernetDatalink 
	 */
	public Collection<SimpleEthernetDatalink> getDatalinks() {
		return m_datalinks.values();
	}

	/**
	 * ..mac........mac....................SimpleEthernetDatalink
	 */
	public SimpleEthernetDatalink getTransmitDatalink(MediumAddress mac) {
		return m_macport_map.get(mac);
	}

	@Override
	protected void interruptHandle(int signal, InterruptParam param) {
		switch (signal) {
		case TIMER:
			// TODO ..................
			this.resetInterrupt(TIMER);
			wait(TIMER, 1.0);
			// TODO ....................mac....
		}
	}

	@Override
	public boolean isEnable() {
		return m_state;
	}

	public
04:46:35.682013 IP 202.120.2.2.38890 > 192.168.0.100.58764: Flags [P.], seq 2873:3274, ack 1, win 46, options [nop,nop,TS val 3100737227 ecr 71665853], length 401
E...
.@......x.....d.......z..$W....*......
..~..E.. void learnMAC(MediumAddress mac, SimpleEthernetDatalink iface) {
	    // TODO ....MAC......MAC..............SimpleEthernetDatalink........
	}

	@Override
	public void registryClient(IClient client) {
		// TODO ......IDatalinkLayer..................
	}

	@Override
	public void unregistryClient(IClient<Object> client) {
	}

	@Override
	public void unregistryClient(Object id) {
	}
}

04:46:35.682014 IP 202.120.2.2.38890 > 192.168.0.100.58764: Flags [F.], seq 3274, ack 1, win 46, options [nop,nop,TS val 3100737228 ecr 71665853], length 0
E..4..@....=.x.....d..........$W...........
..~..E..
04:46:35.682064 IP 192.168.0.100.58764 > 202.120.2.2.38890: Flags [.], ack 2873, win 32747, options [nop,nop,TS val 71666262 ecr 3100737227], length 0
E..4	.@.@......d.x........$W...z....T......
.E.V..~.
04:46:35.682065 IP 192.168.0.100.58764 > 202.120.2.2.38890: Flags [.], ack 3274, win 32744, options [nop,nop,TS val 71666262 ecr 3100737227], length 0
E..4..@.@......d.x........$W........R......
.E.V..~.
04:46:35.682094 IP 192.168.0.100.58764 > 202.120.2.2.38890: Flags [.], ack 3275, win 32744, options [nop,nop,TS val 71666262 ecr 3100737228], length 0
E..4>.@.@.nF...d.x........$W........R......
.E.V..~.
04:46:35.684067 IP 192.168.0.100.58764 > 202.120.2.2.38890: Flags [.], ack 3275, win 32768, options [nop,nop,TS val 71666263 ecr 3100737228], length 0
E..4.$@.@.$....d.x........$W........Rt.....
.E.W..~.
04:46:35.690090 IP 192.168.0.100.58764 > 202.120.2.2.38890: Flags [F.], seq 1, ack 3275, win 32768, options [nop,nop,TS val 71666269 ecr 3100737228], length 0
E..4W3@.@.V
...d.x........$W........Rm.....
.E.]..~.
04:46:36.089787 IP 202.120.2.2.38890 > 192.168.0.100.58764: Flags [.], ack 2, win 46, options [nop,nop,TS val 3100737635 ecr 71666269], length 0
E..4..@....<.x.....d..........$X...........
...c.E.]
04:46:36.108728 IP 202.120.2.2.21 > 192.168.0.100.58762: Flags [P.], seq 695:718, ack 79, win 46, options [nop,nop,TS val 3100737751 ecr 71666261], length 23
E..K.q@......x.....d......wd~X0
....4y.....
.....E.U226 Transfer complete





---- VIVEK end passive





04:46:36.108801 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [.], ack 718, win 8212, options [nop,nop,TS val 71666685 ecr 3100737751], length 0
E..4..@.@......d.x......~X0
..w{.. ........
.E......
04:46:37.617048 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 98:104, ack 956, win 8197, options [nop,nop,TS val 71668188 ecr 3100728629], length 6
E..:~.@.@......d.x........&..cJ... .)
.....
.E....]5CDUP

04:46:38.032891 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [.], ack 104, win 46, options [nop,nop,TS val 3100739561 ecr 71668188], length 0
E..4..@...E^.x.....d.....cJ...&............
.....E..
04:46:38.033325 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 956:985, ack 104, win 46, options [nop,nop,TS val 3100739561 ecr 71668188], length 29
E..Q..@...E@.x.....d.....cJ...&............
.....E..250 CDUP command successful

04:46:38.033396 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 985, win 8195, options [nop,nop,TS val 71668603 ecr 3100739561], length 0
E..4).@.@......d.x........&..cK... ..B.....
.E.{....
04:46:38.033694 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 104:109, ack 985, win 8195, options [nop,nop,TS val 71668603 ecr 3100739561], length 5
E..9.K@.@......d.x........&..cK... ........
.E.{....PWD

04:46:38.442961 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 985:1019, ack 109, win 46, options [nop,nop,TS val 3100739978 ecr 71668603], length 34
E..V..@...E:.x.....d.....cK...&......y.....
.....E.{257 "/" is the current directory

04:46:38.443041 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 1019, win 8193, options [nop,nop,TS val 71669012 ecr 3100739978], length 0
E..4..@.@..$...d.x........&..cK:.. ........
.E......
04:46:40.314852 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 109:120, ack 1019, win 8193, options [nop,nop,TS val 71670883 ecr 3100739978], length 11
E..?Ld@.@.`....d.x........&..cK:.. ..1.....
.E.c....CWD TeNet

04:46:40.692663 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [.], ack 120, win 46, options [nop,nop,TS val 3100742301 ecr 71670883], length 0
E..4..@...E[.x.....d.....cK:..&......I.....
.....E.c
04:46:42.533139 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 1019:1047, ack 120, win 46, options [nop,nop,TS val 3100744130 ecr 71670883], length 28
E..P..@...E>.x.....d.....cK:..&............
.....E.c250 CWD command successful

04:46:42.533212 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 1047, win 8191, options [nop,nop,TS val 71673097 ecr 3100744130], length 0
E..4.X@.@......d.x........&..cKV....~......
.E.	....
04:46:42.533454 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 120:125, ack 1047, win 8192, options [nop,nop,TS val 71673097 ecr 3100744130], length 5
E..9.+@.@.)
...d.x........&..cKV.. ........
.E.	....PWD

04:46:42.942375 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [.], ack 125, win 46, options [nop,nop,TS val 3100744481 ecr 71673097], length 0
E..4..@...EY.x.....d.....cKV..&............
...!.E.	
04:46:42.942458 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 1047:1086, ack 125, win 46, options [nop,nop,TS val 3100744481 ecr 71673097], length 39
E..[..@...E1.x.....d.....cKV..&............
...!.E.	257 "/TeNet" is the current directory

04:46:42.942573 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 1086, win 8189, options [nop,nop,TS val 71673505 ecr 3100744481], length 0
E..4Z&@.@.S....d.x........&..cK}....{p.....
.E.....!
04:46:42.942869 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 125:131, ack 1086, win 8192, options [nop,nop,TS val 71673505 ecr 3100744481], length 6
E..:Yv@.@.S....d.x........&..cK}.. ........
.E.....!PASV





----- START passive






04:46:43.351658 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 1086:1135, ack 131, win 46, options [nop,nop,TS val 3100744897 ecr 71673505], length 49
E..e..@...E&.x.....d.....cK}..&.....*......
.....E..227 Entering Passive Mode (202,120,2,2,230,18).

04:46:43.351736 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 1135, win 8188, options [nop,nop,TS val 71673913 ecr 3100744897], length 0
E..4..@.@......d.x........&..cK.....x......
.E.9....
04:46:43.352842 IP 192.168.0.100.58765 > 202.120.2.2.58898: Flags [S], seq 504855361, win 65535, options [mss 1460,nop,wscale 7,nop,nop,TS val 71673914 ecr 0,sackOK,eol], length 0
E..@.%@.@......d.x........{A.......................
.E.:........
04:46:43.352891 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [P.], seq 131:137, ack 1135, win 8192, options [nop,nop,TS val 71673914 ecr 3100744897], length 6
E..:b.@.@.Jp...d.x........&..cK... ..G.....
.E.:....LIST

04:46:43.760593 IP 202.120.2.2.58898 > 192.168.0.100.58765: Flags [S.], seq 372510634, ack 504855362, win 5792, options [mss 1448,sackOK,TS val 3100745302 ecr 71673914,nop,wscale 7], length 0
E..<..@....5.x.....d.....4....{B.....U.........
...V.E.:....
04:46:43.760725 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [.], ack 137, win 46, options [nop,nop,TS val 3100745342 ecr 71673914], length 0
E..4..@...EV.x.....d.....cK...&............
...~.E.:
04:46:43.760743 IP 192.168.0.100.58765 > 202.120.2.2.58898: Flags [.], ack 1, win 32769, options [nop,nop,TS val 71674320 ecr 3100745302], length 0
E..4..@.@......d.x........{B.4.............
.E.....V
04:46:44.169417 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 1135:1189, ack 137, win 46, options [nop,nop,TS val 3100745706 ecr 71673914], length 54
E..j..@...E..x.....d.....cK...&......H.....
.....E.:150 Opening ASCII mode data connection for file list

04:46:44.169490 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 1189, win 8188, options [nop,nop,TS val 71674728 ecr 3100745706], length 0
E..4..@.@......d.x........&..cK.....qn.....
.E.h....
04:46:45.090783 IP 202.120.2.2.58898 > 192.168.0.100.58765: Flags [P.], seq 1:1034, ack 1, win 46, options [nop,nop,TS val 3100746713 ecr 71674320], length 1033
E..=.A@...:..x.....d.....4....{B...........
.....E..-rw-r--r--   1 shiningmoon 6000        80333 Nov 30  2011 Javadoc.7z
drwxr-xr-x   7 shiningmoon 6000          101 Nov 30  2011 Project
-rw-r--r--   1 shiningmoon 6000        13057 Nov 30  2011 RESULT.xlsx
drwxr-xr-x   3 shiningmoon 6000           22 Nov 30  2011 framework-cleaned
-rw-r--r--   1 shiningmoon 6000        12624 Nov 30  2011 framework-cleaned.7z
-rw-r--r--   1 shiningmoon 6000        32445 Nov 30  2011 framework-cleaned.zip
-rw-r--r--   1 shiningmoon 6000        62043 Nov 30  2011 framework.build.110918.jar
-rw-r--r--   1 shiningmoon 6000       128424 Nov 30  2011 framework.build.111129.jar
drwxr-xr-x   7 shiningmoon 6000          341 Nov 30  2011 javadoc
-rw-r--r--   1 shiningmoon 6000       838366 Nov 30  2011 javadoc.zip
drwxr-xr-x   2 shiningmoon 6000           76 Nov 30  2011 phase1
-rw-r--r--   1 shiningmoon 6000         5622 Nov 30  2011 phase1.html
-rw-r--r--   1 shiningmoon 6000       119808 Nov 30  2011 phase1.ppt
-rw-r--r--   1 shiningmoon 6000         3416 Nov 30  2011 phase1.zip

04:46:45.090855 IP 192.168.0.100.58765 > 202.120.2.2.58898: Flags [.], ack 1034, win 32761, options [nop,nop,TS val 71675649 ecr 3100746713], length 0
E..4..@.@..`...d.x........{B.4.......h.....
.E......
04:46:45.091299 IP 202.120.2.2.58898 > 192.168.0.100.58765: Flags [FP.], seq 1034:1354, ack 1, win 46, options [nop,nop,TS val 3100746714 ecr 71674320], length 320
E..t.B@...=..x.....d.....4....{B...........
.....E..drwxr-xr-x   2 shiningmoon 6000          115 Nov 30  2011 testcase
-rw-r--r--   1 shiningmoon 6000         2046 Nov 30  2011 testcase.111123.zip
-rw-r--r--   1 shiningmoon 6000        17927 Nov 30  2011 tester.build.111128.jar
-rw-r--r--   1 shiningmoon 6000        90087 Nov 30  2011 tester.extern.build.111130.jar

04:46:45.091361 IP 192.168.0.100.58765 > 202.120.2.2.58898: Flags [.], ack 1355, win 32765, options [nop,nop,TS val 71675649 ecr 3100746714], length 0
E..4..@.@......d.x........{B.4.......".....
.E......
04:46:45.091572 IP 192.168.0.100.58765 > 202.120.2.2.58898: Flags [F.], seq 1, ack 1355, win 32768, options [nop,nop,TS val 71675649 ecr 3100746714], length 0
E..4..@.@..y...d.x........{B.4.............
.E......
04:46:45.498900 IP 202.120.2.2.58898 > 192.168.0.100.58765: Flags [.], ack 2, win 46, options [nop,nop,TS val 3100747040 ecr 71675649], length 0
E..4.C@...>..x.....d.....4....{C....G......
... .E..
04:46:45.499161 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [P.], seq 1189:1212, ack 137, win 46, options [nop,nop,TS val 3100747040 ecr 71674728], length 23
E..K..@...E=.x.....d.....cK...&............
... .E.h226 Transfer complete





---- VIVEK end passive






04:46:45.499220 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 1212, win 8190, options [nop,nop,TS val 71676055 ecr 3100747040], length 0
E..4,.@.@..,...d.x........&..cK.....f......
.E..... 
04:46:50.276467 IP 192.168.0.100.58703 > 61.135.185.140.80: Flags [F.], seq 0, ack 1, win 16384, length 0
E..(V.@.@.,....d=....O.P....`Q..P.@..>..
04:46:51.044698 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 122:134, ack 976, win 8196, options [nop,nop,TS val 71681595 ecr 3100735695], length 12
E..@f.@.@.Fk...d.x......(.....>... ........
.E.;..x.CWD /TeNet

04:46:51.431300 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [.], ack 134, win 46, options [nop,nop,TS val 3100752992 ecr 71681595], length 0
E..4..@......x.....d......>.(.......z......
...`.E.;
04:46:51.431545 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 976:1004, ack 134, win 46, options [nop,nop,TS val 3100752994 ecr 71681595], length 28
E..P..@......x.....d......>.(........I.....
...b.E.;250 CWD command successful

04:46:51.431612 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 1004, win 8194, options [nop,nop,TS val 71681979 ecr 3100752994], length 0
E..4;.@.@.q....d.x......(.....>... .Y_.....
.E.....b
04:46:51.431834 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 134:139, ack 1004, win 8194, options [nop,nop,TS val 71681979 ecr 3100752994], length 5
E..9&.@.@..f...d.x......(.....>... ........
.E.....bPWD

04:46:51.839980 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 1004:1043, ack 139, win 46, options [nop,nop,TS val 3100753379 ecr 71681979], length 39
E..[..@....z.x.....d......>.(..............
.....E..257 "/TeNet" is the current directory

04:46:51.840075 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 1043, win 8191, options [nop,nop,TS val 71682386 ecr 3100753379], length 0
E..4.3@.@.!
...d.x......(.....?.....V......
.E.R....
04:46:51.840754 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 139:145, ack 1043, win 8192, options [nop,nop,TS val 71682386 ecr 3100753379], length 6
E..:..@.@.!....d.x......(.....?... ..m.....
.E.R....PASV





----- START passive






04:46:52.249478 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 1043:1093, ack 145, win 46, options [nop,nop,TS val 3100753790 ecr 71682386], length 50
E..f..@....n.x.....d......?.(..............
...~.E.R227 Entering Passive Mode (202,120,2,2,158,159).

04:46:52.249626 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 1093, win 8188, options [nop,nop,TS val 71682795 ecr 3100753790], length 0
E..4".@.@..6...d.x......(.....?C....R......
.E.....~
04:46:52.250556 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [P.], seq 145:163, ack 1093, win 8192, options [nop,nop,TS val 71682795 ecr 3100753790], length 18
E..Fy.@.@.3....d.x......(.....?C.. ........
.E.....~RETR phase1.html

04:46:52.250595 IP 192.168.0.100.58766 > 202.120.2.2.40607: Flags [S], seq 4120106672, win 65535, options [mss 1460,nop,wscale 7,nop,nop,TS val 71682796 ecr 0,sackOK,eol], length 0
E..@..@.@.-A...d.x.................................
.E..........
04:46:52.658196 IP 202.120.2.2.40607 > 192.168.0.100.58766: Flags [S.], seq 376537730, ack 4120106673, win 5792, options [mss 1448,sackOK,TS val 3100754197 ecr 71682796,nop,wscale 7], length 0
E..<..@....5.x.....d.....q..........qT.........
.....E......
04:46:52.658272 IP 192.168.0.100.58766 > 202.120.2.2.40607: Flags [.], ack 1, win 32769, options [nop,nop,TS val 71683202 ecr 3100754197], length 0
E..4'.@.@..b...d.x...........q......5......
.E......
04:46:52.658829 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [.], ack 163, win 46, options [nop,nop,TS val 3100754238 ecr 71682795], length 0
E..4..@......x.....d......?C(.......p......
...>.E..
04:46:53.064016 IP 192.168.0.1 > 224.0.0.1: igmp query v2
F.. ..@...Cm.............d......
04:46:53.065333 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 1093:1162, ack 163, win 46, options [nop,nop,TS val 3100754603 ecr 71682795], length 69
E..y..@....Y.x.....d......?C(..............
.....E..150 Opening ASCII mode data connection for phase1.html (5622 bytes)

04:46:53.065406 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 1162, win 8187, options [nop,nop,TS val 71683609 ecr 3100754603], length 0
E..4..@.@......d.x......(.....?.....L......
.E......
04:46:53.065530 IP 202.120.2.2.40607 > 192.168.0.100.58766: Flags [.], seq 1:1437, ack 1, win 46, options [nop,nop,TS val 3100754615 ecr 71683202], length 1436
E...@(@....y.x.....d.....q.................
.....E..<HTML><HEAD><TITLE>Phase 1 -  ARP&L2switch</TITLE>
<META content="text/html; charset=utf-8" http-equiv=Content-Type>
<META name=GENERATOR content="MSHTML 8.00.6001.18928"></HEAD>
<BODY>
<CENTER>
<P></P>
<H2>Phase 1 - ARP&L2switch</H2>ACM Honored Class 
<HR>
</CENTER>

<br>
In this phase you will need to implement the ARP and L-2 switch that are the basic of the network. Because of complexity of the system, we will
give some frame codes in the package and you can use it as the beginning.
<br>

<h2>Address Resolution Protocol</h2>

<h3>Introduction</h3>
In this phase you need to implement the basic function of ARP(Address Resolution Protocol). 
<br>
If you need more details, please refer to the following hyperlinks:
<br>
<ol>
<li><a title="Address_Resolution_Protocol" href="http://en.wikipedia.org/wiki/Address_Resolution_Protocol" rel="nofollow">Address_Resolution_Protocol</a>
</li>
<li><a title="RFC826" href="http://tools.ietf.org/html/rfc826" rel="nofollow">RFC826</a>
</li>
</ol>

<h3>Implementation Specification</h3>
The all codes should be implemented in a new package tenet.protocol.network.arp. There are some basic frame codes in the package and you can use it as your beginning. <br><br>

The Goal of ARP protocol: Manage a mapping: physical address <----> IP address.<br><br>

The basic process: 
...A... sends an ARP packet to request the IP B physical address. Any one receive
04:46:53.065669 IP 202.120.2.2.40607 > 192.168.0.100.58766: Flags [.], seq 1437:2873, ack 1, win 46, options [nop,nop,TS val 3100754615 ecr 71683202], length 1436
E...@)@....x.x.....d.....q..........X......
.....E..s the ARP packet and analysis the packet. If it is the IP B then it will response to the source, otherwise it will update the mapping and ignore the packet.
<br><br>
The points:
<ol>
<li>The ARP protocol has 2 different models.
	<ul>
	<li>	Flood: You can send your information to all nodes periodically. </li>
	<li>	Lazy: You just send message when you get a request.(In RFC826, it is recommended)</li>
	</ul>
	</li>
<li>	The Robustness
	<ul>
	<li>	Decay over time: The information will be removed after the interval time. And you can send a message to confirm it before you delete the information.
	</li>
	<li>	Lazy: Don...t worry. 
	</li>
	</ul>
	</li>
<li> The initialization
	<ul><li>	Broadcast first.</li>
	<li>
		If you have some special settings then do it (e.g. the Decay).</li>
		</ul>
</li>
<li> The ARP package
<ul>
	<li>	Source IP &destination IP</li>
	<li>	A sign to express the request or response.</li>
	</ul>
	</li>

</ol>


<h2>Layer-2 Switch</h2>

<h3>Introduction</h3>
In this phase you need to implement the basic function of layer-2 switch. Operates at the data link layer, Layer-2 switch interconnects a small number of devices and transmit frames among them. It learns the MAC address of each connected device and records them in the MAC table. While transmitting frames layer-2 switch looks up the MAC table according to the destination MAC address and get the right port to 
04:46:53.065741 IP 192.168.0.100.58766 > 202.120.2.2.40607: Flags [.], ack 2873, win 32756, options [nop,nop,TS val 71683609 ecr 3100754615], length 0
E..4..@.@.!;...d.x...........q......&......
.E......
04:46:53.065805 IP 202.120.2.2.40607 > 192.168.0.100.58766: Flags [.], seq 2873:4309, ack 1, win 46, options [nop,nop,TS val 3100754615 ecr 71683202], length 1436
E...@*@....w.x.....d.....q..........3z.....
.....E..transmit the frame. There are four forwarding methods a layer-2 switch can use. Here the ...Store & Forward... is required, that is to say, the switch buffers and verifies each frame before forwarding it. However, how to deal with a crashed frame is up to your own design. 
<br>
If you need more details, please refer to the following hyperlinks:
<br>
<ol>
<li><a title="Network switch-layer 2" href="http://en.wikipedia.org/wiki/Network_switch#Layer_2" rel="nofollow">Network switch-layer 2</a>
</li>
<li><a title="Flooding algorithm" href="http://en.wikipedia.org/wiki/Flooding_algorithm" rel="nofollow">Flooding algorithm</a>
</li>
</ol>


Generally, in order to achieve this task, you need to:
<ol>
<li>Design and construct various packets to exchange routing information, such as HELLO packet and ACK packets.</li>
<li>Process incoming packets, calculate and schedule packet generation and sending.</li>
<li>Be careful of some tricky parts, especially when you distribute packets.
Carefully read the text, and implement sequence numbering, aging and acknowledgments in your implementation.</li>
</ol>

<h3>Implementation Specification</h3>

<ol>
<li>Forwarding a frame<br>When the layer-2 switch is to forward a frame, it looks up the MAC table with the destination MAC address and forward the frame using the corresponding SimpleEthernetDataLink . Once the MAC address is not in the table, just use the floo
04:46:53.065854 IP 202.120.2.2.40607 > 192.168.0.100.58766: Flags [FP.], seq 4309:5737, ack 1, win 46, options [nop,nop,TS val 3100754615 ecr 71683202], length 1428
E...@+@....~.x.....d.....q.W.........T.....
.....E..ding scheme. Flooding means to layer-2 switch tries to forward the message to every one of its neighbors except the source node.</li>
<li>Updating MAC table<br>The MAC table records the mapping between MAC address and SimpleEthernetDataLink. When a layer-2 switch receives a frame from a SimpleEthernetDataLink, the switch gets the source MAC address in the frame and updates the table by mapping the address to the corresponding SimpleEthernetDataLink.</li>
<li>Components<br>Most of the methods you need to implement are given in L2Switch.java and StoreForwardingDataLink.java</li>
<br>
L2Switch.java: 
<br>
This class records the data of a single Layer-2 switch, such as the attached SimpleEthernetDataLink and the MAC table. 
<br>
<br>
StoreForwardingDataLink.java: 
<br>
This class extends SimpleEthernetDataLink and you need to add in the ...Store & forward... function...In StoreForwardingDataLink there is a queue buffering all the frames to forward...You need to override the methods of dealing with different signals to makes it support the function of layer-2 switch. The method onSendOK has been implemented as an example for you. 
<br>
</ol>



<h2>Testing and Grading</h2>
We will test the correctness of your ARP & L2 switch and MAC collision detection in this phase.<br><br>
Efficiency of you design is not required here. However, an inefficient design might have a bad effect on other phases.
04:46:53.065883 IP 192.168.0.100.58766 > 202.120.2.2.40607: Flags [.], ack 5738, win 32734, options [nop,nop,TS val 71683609 ecr 3100754615], length 0
E..4y.@.@.3z...d.x...........q.............
.E......
04:46:53.066240 IP 192.168.0.100.58766 > 202.120.2.2.40607: Flags [.], ack 5738, win 32768, options [nop,nop,TS val 71683609 ecr 3100754615], length 0
E..4R.@.@.Z....d.x...........q.......|.....
.E......
04:46:53.076781 IP 192.168.0.100.58766 > 202.120.2.2.40607: Flags [F.], seq 1, ack 5738, win 32768, options [nop,nop,TS val 71683620 ecr 3100754615], length 0
E..46.@.@.vg...d.x...........q.......p.....
.E.$....
04:46:53.477063 IP 202.120.2.2.40607 > 192.168.0.100.58766: Flags [.], ack 2, win 46, options [nop,nop,TS val 3100755021 ecr 71683620], length 0
E..4@,@......x.....d.....q.................
...M.E.$
04:46:53.487120 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [P.], seq 1162:1185, ack 163, win 46, options [nop,nop,TS val 3100755130 ecr 71683609], length 23
E..K..@......x.....d......?.(..............
.....E..226 Transfer complete





--- VIVEK END PASSIVE






04:46:53.487248 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 1185, win 8190, options [nop,nop,TS val 71684028 ecr 3100755130], length 0
E..4..@.@......d.x......(.....?.....H8.....
.E......
04:46:53.677794 IP 192.168.0.104 > 224.0.0.251: igmp v2 report 224.0.0.251
F.. e|.....P...h..........	.....
04:47:09.052783 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [F.], seq 137, ack 1212, win 8192, options [nop,nop,TS val 71699588 ecr 3100747040], length 0
E..4(P@.@......d.x........&..cK... ........
.F..... 
04:47:09.431160 IP 202.120.2.2.21 > 192.168.0.100.58757: Flags [F.], seq 1212, ack 138, win 46, options [nop,nop,TS val 3100771003 ecr 71699588], length 0
E..4..@...ES.x.....d.....cK...&......5.....
.....F..
04:47:09.431240 IP 192.168.0.100.58757 > 202.120.2.2.21: Flags [.], ack 1213, win 8192, options [nop,nop,TS val 71699966 ecr 3100771003], length 0
E..4.%@.@......d.x........&..cK... ........
.F
.....
04:47:14.335985 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [F.], seq 163, ack 1185, win 8192, options [nop,nop,TS val 71704864 ecr 3100755130], length 0
E..4..@.@......d.x......(.....?... ........
.F! ....
04:47:14.336330 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [F.], seq 79, ack 718, win 8212, options [nop,nop,TS val 71704864 ecr 3100737751], length 0
E..4O.@.@.]....d.x......~X0
..w{.. .I......
.F! ....
04:47:14.749614 IP 202.120.2.2.21 > 192.168.0.100.58759: Flags [F.], seq 1185, ack 164, win 46, options [nop,nop,TS val 3100776289 ecr 71704864], length 0
E..4..@......x.....d......?.(..............
...a.F! 
04:47:14.749678 IP 192.168.0.100.58759 > 202.120.2.2.21: Flags [.], ack 1186, win 8192, options [nop,nop,TS val 71705275 ecr 3100776289], length 0
E..4.
@.@../...d.x......(.....?... ........
.F"....a
04:47:14.749763 IP 202.120.2.2.21 > 192.168.0.100.58762: Flags [F.], seq 718, ack 80, win 46, options [nop,nop,TS val 3100776292 ecr 71704864], length 0
E..4.r@......x.....d......w{~X0............
...d.F! 
04:47:14.749807 IP 192.168.0.100.58762 > 202.120.2.2.21: Flags [.], ack 719, win 8212, options [nop,nop,TS val 71705275 ecr 3100776292], length 0
E..4._@.@.'....d.x......~X0...w|.. ..o.....
.F"....d
